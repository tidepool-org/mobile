env:
  global:
  - secure: PImFNaBaH6agcH9D2OyJENhOcTlPkZIPFF8j+h+L7pw7GtZhFdlbnR1rF6EPV19YuqT2IckVTS90mQE53HCL1R9/PXVaYa7etj3En8YaiN1iqvANMtSAAgdHXUFiAtXBYFNVbF5pQg1Ejjk+UMjKZPVzb8Xap05wVlLhFkX9Pbh8XwSgTOSGWgp7HQ7SIoWDjgc3Gb6wn3Or02N/22prXt4KgLC7DwFo2qdwcLUYdxeWjToJoHdLFuhodMhry3fN6RJ5z8DGpyyssvaYtsH1Psly/n/AL/a72VEThRGBHGCizYBdGyjywkAQ3rJedbJwLLdWojt8nCWlXsY/L4vOc+eD7sorfMPsUB5IdE+8U+4SkkTDoSogSKl3DLUmQgtgl7ZtHYWdLZwyJ3eurT18upQ1A3kK2khHrDE+2JS699Ow7Bjzm9V23G55M1jbyFTIchZZMfDY2ORhxuSALErPz1CsaeKgKoWtvqWUG+9h/1iwwJThyajGsdeRKYeXzmbTXgTJ4aeuDzWOk4gMX+A65/ksEXxOVJCmW4ScCGHJkvhC0urktTtd0Z+MNb4tlto4Nd94NlHr5JqFQAgEvVqIKA7Sp2UsF82VqODtDrMDACfRzGR4xVZF9KSDLXQmIiYKpPRs2BH+rG+5VESYdfUZPrRElQ/u6dlL9LCPmlQXEg8=
  - secure: Km8AGRbQvsuV4sTfadw5iqhVcjCBPdndtDt3LAjkZ9pGdpvbnjvJ2rjLK5V5Tx57dMw4R+pvEde53m230P5bOyPFEHptZipHJriHu1bGxmFeaPssf8onYcGbV3XV5lpeN8rzoVei18b/zGIPHBC7wTqPSSnUnNrXrXpwu9LVp4R7+lKOwpZxLwRGqKOi2Heem0T4AijW0k0xThqKZ7QYE/0x5aE2sdOcoSpP9Iz5lzhZkvg8Uyh2GscgCu6JC0X9eEqs71fJzyJS3e6SeEnniVOmMCURrrs/vSKgsHoQB2Y5j8t6q/j+W5H+zVHKZE16gPVtaPlRXZtH9TLW/9CwHU3Fit9bz42olNGWOjfkbURUsA7VG+YRpAJgS/xjlq3dRJ01cF8TU/vfLz1a49foe4HYjXjm7/vjb5KXi4ETWydOvMARR/TEd9SB7//mD4wgKGd4zjf7f2lVhJYx8DbvUe/yj0asysDLjy6o4hSSU0lRht2TH7U6N0tCr00X4IDDFYZOH86ak2iV+irNg6iWv0MTc9fNKKIjhiARAwQI+OY4EjaaNWTruhoYWZiAiOv/DF8PvL4orrysnhDUMY7ts3VrCHEd2wQ6CdiiTKd9NeWv7LPTCcYRd6ltA0CZZQxGlOWEpB7UWzFvYEgyXPMJBykONdxYetwXOl7A21m6aHg=
  - secure: dQqF6IhJDH2Yf2RFjYZOk+HvT5ZCCEumYdISjwuM0fznS6E59YFvD/bPBMleFQ2JHZIQJHrAYFUj1F64uaDwA4uNb6DICnMqp/cb01GdjFbtwrwL/5AI1ZxYJiCzPoEZ/Hqj667H+682pkyvUPD9dcxbURe07/qCQImhfhqR0SseC025gaRX5P5REF0jaTh975fn27nIhtNgIBKcdZutFidcTyRHQzw9875a337wkiQjP91uWZO1TXlD0hT9fgehuGE/9zaoj6eda//lvLKy3KSw9tBQwlq79n60Gk6in0fI5k/kpNYiEnw/433iHJpeow8fYtBytcH7GrFzKB6fKaq7QTvTixW+PcOaV3yhksN5/nN6YBBFzxmzjwCnQSJwzTHBXUreoDhqYL+TNvGVPbfUeMagqaK6jeR/3XVrpGeOnEy9/H9U9N4TANx78tW40DbkEP/CxjenlCJyyDIkmoHKhk1CDMYZkHlORzjlNoggzfVcCdXO2vm1VV0N3n8e5PurTBpBGaZs/8CCNNLjlyS/foLTQiCPYMHN9aiUQyBpas0z/s8xnG3oEBHr2dfazlhdKKQXxpB0F1fSw37gGohZHNZhrxKWXGn057lk3yeOrtRInM7mRPtd5YtdMISoe0bgq1yza5KxHRbNYWYwrGafzjY57UGF3FKwTpPfMwM=
  - secure: GCfgQ9wcqE83XO6f4XSUUvxisdJ0pdLCq05qN6VeOHUFjyixBfl5EkFre4xljWoxwv7hNJkTpZvD/pR2Mp2jbMLys4qJDmUHXNeswkp4dpvLw+SQEKkRyQHgOqUw1ewCnDwe+J0hHne9jmwLTGhiq9O8+mXTbSoRz66BKzS8Yf8rswJdwfTxqe2sVpBdiL9qI0C+7sfQTpCyY5Y4fyOLnM9DVvXpZmhnmXnTdKWVnOJ/TdJ0oBX7vUIxeLZPGmtGqGZAygdxEfKutjbo7IPbY2aZvNDMECP1hiJAnwfXSAUswlsYZuDcnPzQOg6MuSqcHjXu9zAssK32rm36j5S2zLH3KZmIvHoCUkJ8rfIPUZaAMoTHtzpL87YrMwft3lScDVaNSmZI1gmZaIg7EsEW622zQajV7azhgc3ld4XwrzPMzs+FcuYrben2PW0uO3mXsf50czlx9m4fbTv0EbgdwFOMxZNBxxKzBhre2t6BFLZi8h3UcQNegrxPcGk3mZ9Ecijq6xentT6QVYpQ2GB0m2H911I8SnJu9UNsjddqXtN2vnJP506dZ8yMFEr2MhrHQ0JlV4io+rZrGbhERJnjIyTPOe8U0UvyR4H4AltD7U3pv3Qqx4lZFcYkuv02xePW7JSnCfSW+4xXaAzGblXC5vzQkD41MANslOXYj5vj5xY=
before_install:
- openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
  -in release-keystore.jks.enc -out release-keystore.jks -d
- echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
- sudo sysctl -p
- echo $TRAVIS_BUILD_DIR
- mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
- nvm install 10.15.0
- npm install expo-cli --global
- curl -o- -L https://yarnpkg.com/install.sh | bash
- export PATH="$HOME/.yarn/bin:$PATH"
- expo login -u tidepool -p $EXPO_PASSWORD
install:
- yarn install
- yarn run pre
- expo publish
matrix:
  include:
  - language: android
    jdk: oraclejdk8
    android:
      components:
      - build-tools-27.0.3
      - android-23
      - android-24
      - android-27
      - extra-google-google_play_services
      - extra-google-m2repository
      - extra-android-m2repository
      licenses:
      - android-sdk-preview-license-52d11cd2
      - android-sdk-license-.+
      - google-gdk-license-.+
    script:
    - pushd android
    - "./gradlew :app:assembleProdMinSdkProdKernelRelease"
    - "./gradlew signingReport"
    - "./gradlew :app:assembleDevMinSdkDevKernelDebug"
    deploy:
      provider: releases
      draft: true
      skip_cleanup: true
      overwrite: true
      api_key:
        secure: eGk21GoWqTpy7JXrYMybgGF7hb59qWCDTHR2F5MssCL4n9inAoD/5TAaTvOJjYQjqApAa0ndz8yH85GbSWW5uQDnENJiNV7vPDzFiEkKeFpniLzgQpgwdODdFaerLMiGxRzzc+tH12ZUvmmx/gtcsgJxEAtV6+1wot6ONuK9ix6kl8+yuq3/HgpdRVM/HYPsqXE6q34jFfAscOCW6GaP+xigNNvEIr3H4Ljupp6OaubPmYTgqhwq8l0rEgCiniohSJg5l1ybQ55MjYSUoLb2IRGsgLC5aE2xBlQwlOEDQtBiCIGSDt7aX/UZqIl0/UH/LkPyftT25qEyFMkFucJW4uLoG94cbbrSkVoySeU005MF212J8pxZUivoyqjmA51gENA1G/PVR9uaKdFGBhtB39Hrr6+6c8SaFyKg33HRy46soDMhQw4Cdv3gS2DfLPnUf8ITMnSNVUshr8A0EWF3v1Ykdg1oul+GZqY8EsQ9xe7OHWN9Ap7Kkt/N82JsRFzQsQSFzrvPZvdkHRVUHMiN8kRFFnTnOb5TbFoZv0m4fPapoagNghkyW0TxLtztx3DShTljbskT3H+Mv4+u5DqoGyxFEI/S7xzFEsFZkpxi3FQVL7id0GQa3/+9BBUVgm7hN8csyMcQouCYdIEQTgRhfNBNWPRYy/4BDOyHLApOtpo=
      file:
      - "$TRAVIS_BUILD_DIR/android/app/build/outputs/apk/prodMinSdkProdKernel/release/app-prodMinSdk-prodKernel-release.apk"
      - "$TRAVIS_BUILD_DIR/android/app/build/outputs/mapping/prodMinSdkProdKernel/release/mapping.txt"
      on:
        repo: tidepool-org/mobile
        tags: true
