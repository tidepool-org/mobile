env:
  global:
    - secure: u/g0Wgj2SebyLYshN1y+pIsJgsh5gNtIjXanVFcI0vSDJSVBXkNuCz/iJfXfKCvkmODakuzeekXg26xF9HzWMSQ+7J5Vodldm+0a5d05ybQQiJL548RBkXuTfSl4pUAFm5zgkeQjnFNO7+fze57Ezj0IHUIksOV9kriY+x8mITSfUZr/oAR1SYIaL3/tnf88fmpv1XIVQgH0nzOoALAfye3PMSQPtAWrccZTSFtkZ+lbthFgFWWxxOtj6clKtXIh3PL1dUOqdB0z636JzwfzqnYpPMfmFe8O1Kff0plCPEU75Oo7XZXFiHL48BKm8VqRWd9RSYndMPyALZXJddUYEhCQS+RolfY09xK8b4hBQZdPQZ2V+fFPQw7XJO/P+e0N3VqsuRobVM6jkQVCatvaAiMMPJKKRCqUEjN0pTyqzSWQs2lRYHluu8dpwNukQhBpdo3oTGftLkFznJ2TpPsTqVNHFg41ijX4jBl54uIpiOFCCxw3V7okEJzKPeCSG9Qp4EG2+1LKCFvGmbyLQd6Qa+ONBsi6PV6FyZQwzqoqx+ptulyiGNSYy+K+lizOj78XkMklsv5pXA3TQgnnb5KsKmQDFp1ArYnp238xG8N47fR17THGRko8E9q1YREglRmfPdWO/6fi2GtgvPntWqbvQC/c9jEsHC9TmYzeQykp7pQ=
    - secure: ZEPwXWX7aEAIJNU9sdLjmoQECk//VK7o7xPrt3IcNQHCcGDd/GaXlTfPBklefa4lFVRAZyVyBSGmioIZ2dylYw2xpilUvR/xAvlcjZ0yYv60EcGEcurKOde8j2M5al5krkOeZH4xM93I/t6Z/VTKVw12H5AGHTZDZUQ5BtgnKj9olF90EtvTN1OK6SVQtxp6EYLmgf5juzsUv4wDK1FQgXxhTlVoHHnQ0iW/VwvCPlO5XdTgDMlZafIYnNgoUUnIaGYYYZ+6SLwsVFpaYEBCu1fF/KEKcMOpncMWVQivUC/++ZHTgiNLLPXJVcDlXE6HMTvfZvzD2esIaGHhBzdIyNoqONJNnp23ShUaJebm244iTnrPBxSV1fsoCUldibqKX6zJa6J/jDBlErr7Jlot8LIkrZdBdwadSnnJcC+7loXP55hAgH9m4T09ef1gvqSx2lecpZ9pBgKXXytV+01Au8ZRrlVrXCQaamPrhJ1VGnNKSmUJA3XSgOAidJejA9aJ0NHz8I2DIXygO+pWaVnc2GnsrrcXIkBd8SaYDuu7J5DnXMC2v+bhqaqvO/XgmDy8JudsAZ5nyEfnxX38uF3nkCWSTm9OLOn2ZpzFk0KK3zxbUUXbVe5QdjJxRlqn9buT9ndiXtQoN7EZn4haiTBMYurV1hbM2V9VdZvtAwvt2bI=
    - secure: CHxnfSousglzfvg2GufVO5Fxg/EWVS7A05tHOWbU++L/8G6TOW6JdCl7ORyeEPaWbUWylt2kMSix/Gd04b7CWzllA+VwXouZA9DgRiu8v6kIo2Q508VRcPcWJcRoDvjmNbOW+Kd8b1APgyAL7cWfFiP2Ci0VxOcn+il69CgbrQOfqJa2J+F/xdAqTGNDqYrX2UHWjfjHUvUSArr6m7c1AJSWfgagwvrT8uAvCKDSy8K4R3LNNa3T//YyGYs71RlrV/OQ7CqxASECnSjgfCnSy4gL/4JEV9ewEE8D4KyAi2zwj5ci8q7CyxE1C9Y0BWY3qdjemn3m8iBUsrDmEdMSphq0BI73rQw2ZndbpfBqluUKCPOTzuDrT6Ct2xqovUq7GhXd3FmLfskXqj3mw5DjEvL+NAopCDh3sIor99MPkaJjHHdkgqzDMj+sa1LiA9W2fbuW5vrV3jKYw5hoC/uEmgrOnKIji8Gn0+3klihvz85jNVHXtK4LmKvQo2GE9rksdRkZEAmJxYgn4lyJZxoniUbUv9+9xMrQAjJ0WTGF16DYEbcwd71gT18PeUULhXSAAqZuN/4/2WkjIOqcXapKz7Vcn8Mx/bBypRmpiZkWOA6sH/tcn3yp29alubIP7Q6xG/2Y722mNZdlwXN01sqJBh2QCVzsXbCtzlRCBjROM9k=
    - secure: cJRNaWVAD4PqD/SH/S8ixVBW+3G0Q1+eH+XeJzTO4YXFKYlXJzwqsK9Zj0NhSk2JFRxzu8A/qXlSyhwSrAIEclFLAGZUFxNIqkG+B4VgW1SVh5/9ftSu1/4rzuIuHWdkiHLS2STa8hDs3dsWY4SyfPGYOxXagA7hP1tpl+AH8vGZdSUbaVhnyXBc9uOPnbR5c7Oo/QW3x5C5JK+J+7tja3ySOpbOboOoaMZ9HPuVJhTfHBVvA4dtlBqYxrcclVy2XS+rYlKUuimwQPi9OIKG6KVAv98O/hEcOy5AFzYNuLdmC3bnvdLLwa6J1tzBzdcJ9DUKgDek7eWhglvXgdocq8COnBWJqohWeUg3P2yeHFVI2qqYRQ3a3s7AG0ZuemTud/0ml/nf/exzYJf67y1UA5M/M1dJsY7Z/J0yaFpWtD4+Esxp0NQqswJllNtqPeTMvrMsbp2en+WVWuEWKm12s8Lgh+i520RPKxZp1CqgsPlLUfux6NRFmkVUNkfsd9yLy2zH0LxDj7zNjG6u5WYtvoROWSUDiOaAtt/xPkNua7snq9CHV7eiGCxejzpFMzqzSafUZWbSUtJ0+W8jWJc9XeIT+33hOmKIHS9sEt7+jW9WwtrFYyCySz9rO2NQ1nEnMNla9kEASHkF6ZLmJoWWe3srDds/NmarL7yci8dmtVM=
    - secure: WY56S2Qy1OZ9JdY7XSxBd73LB+N/Y4082cbW9rREpQozXb8hM+fzbjdv6jku2NsOHr1MUrzYCKQImFEoLDqywR1wS81LZTw6AwP8J+icleWdekViZEd/KopnJbOh347HvfAzk7iedn1bTgJBcNGKsXqlcN4I6Pr/8GnIRY6oZzblQkEBPIK4yIrTKzhA5JGzKKIAscAxxCYbpjxxb6jqYTTrxkBenIxYu9bOgeEDUCK2/dMxAsbcDE/QfgB+mKC0+vHMTMmOrFlb9cWWG6zvLr5p2d7cEIXj5EMDggGF5tlR7XSLghTMfnuosx+zJz9lE2InSTrxtaLHGrqM/NOOOkNQTfpSTzm5z0msEH0kJ/8MkBK1agC9+BABNj7+nuBDda5kW4CS+MfwPNMKe5v8iZ3Z1ddq/JCZZbBjhuM+mg1zxGDA1CAskJFC5cKD8XvQ6MTeIF+1P6dRvhb/OFqIzbYFJcxljxhz38n3ezFYtWqESQ/8E2iuVLN96kkuvTXLgMpoJmu7SakR59a26ZDDk49oZzPClLmivX2jNBHn7DBMzM6Utdm9XFjxPDSChQLAExtykOK2g1T4MBG/efvW2dxkTcGPorAatWErDjOQIqHyvwNdsiqNKGd4ysJk3yLOzS6ACHXSPMK/yQkRJLrTXdTxKQfDV9YsH9wAIVX11NI=
    - secure: UsceFkW8EEWs9Rdmxx148X0KPed+hN+CcX6C2/hHASUFdfE+I0B618pyjMRK65L8R70xpX8CWvH3V8Wfa7GfLLS4MCddRRg9BvJiW0Ig8pXyO2wrIAvyPuT4maAuTqi7oW/0TC9V/LOEeQygULqAlazNTEpWmK7cFZ62HUsATmTO1Ra/5K+fYmZzt+1/Y2py86lAfAJrAH4t1zlXg43C3hxa+niimh6gfAk7xIU26nM0e7w7pf6Jq0cYSz9lL7Pwn0Ac5HClBGeSChP/PtZ1b2PL3djp+ab3aop8c69K8tfAoQqELorjMwByp8Qf9R8iqfWdgLrcaodKEI0uGP+aPMVZEvH1eX6HMdgGaDP3f5Gj/o9hLeGgH+nv+XRafsbGfhaKE8/crmIm9M2Zel56D0zh/IsEbf59ISY+jNjukoM0vvu+mHfrNn1sJ7QWD/fTskiHlrQE6bTUT16zC+fMlZKw6YIpxsIEzReK4UmPLLdtkYQ4lGYsYImtKFvrBDZYp78HdqwNIkPhwoAynOvrkcF9wycieQoPqqVE1B8gEqkg7UCivbVEG0/CS4cYdMd0KxemJo1Kg38hreNJUH5JubqRNdqIVGqGwXZGEbrvYYzMzcsSHrycNKHObTHtW9T7fRTHSSj9s1KD1jjxTOPtjAzfDdObw9f6SDKW+XR6qYw=
    - secure: yMl8yn2y1y0AZA/EmD6EDMG6aLd5nHK2POCpnI4MfDdc5Zh0gIAkEfSfZmEHl5PkjEPLyfXyGPokzxdL5HQZ2lEjyDd+PPLRAP0T3i21rUe+a6WtCV/LH7g+Lq701t5Zi6jzFcb9fUBhL8kVzBqcG3e+fYITdAuoBZ7UMPmQLDo3Es+R7VmYFE+dHW3WLZOqHpRPfcGC9iTN5X3UCZYCvVWZDi9nTSpg3DaAKOBfDp+SzKOWfw76daRuHf8VuozPOr4dF8jnwL0kZQUAeULpGiFdGMbFpEvjMTtuVxICM0lRTHQgxJgjwCe2BWqKXCal5+iLu9Rt/gfFtarcbhzeoCAdUZC6ZJFy2mcdubexEPfmA6FBrsD0JnnVaVG8bjHAj6FgwxgayFcs4ZuVXVOKOhSPI0Jebe7SDfajNibnHy+THZE6leSfXNLJNejnkQk3LxendnpaWtP4Z94fQvmk9Uv3PXyI7/2NczHl2E8E9UtIrQd7V8i9uHxbLSGswd3ANWAiUk9h4ymocieIIwV2eiyuWWnZc99gZZaor190cCaGlmpImkwLF3otwsWB8rhQNsex9ixp8euetHAVJspKNheRHSXf9P2v0J441Sm/kCq+if+TCL2nWnACjOySp5lATORcMSvVSab6uKDBmgaxRYKqgWZKxA4F7KlKm8oBZCU=
    - secure: pa9qDsDyZW87UVr4hl+vhHFitbxmJbOjc/MeveZxxOmU6vNMqNuXRbV5n2ZGoObYayt9D9qLq3MoCQM/6R8vSNei0Thbjy3ehbYc6aZovYQMmkaVPd4kVkME9GiNbwvB+JsRK4ET97ZqmV5dkJhINm+CAo2D1M/FhbwHHD6eFpPauGnFklJ1vcPkHI07G0XS6jLrotNZF4y34RI3hEGn7gpn/SDByckOA6yHTfeWH/1mcn+OVTqUTBPtMPoOV1kxBfY4n0SLhyr9We8KneI7Ysd8rKYDaskyrkG70u9bc1G+4eg97Pg+urp6nagOsf3ttHb3T5yF5lA4u/BCM1YooRLOl6sJT+7+UI4KNtE0xOlTSRQtPu7y9jmHOypyRX9Q3maux2JjjrAYSUsuarovHqlqCaeqbJhc8tW9O1euDhMjYViBuRiDlUSVwx1FWTCmatvfk8VB5VJgb5IlFjHEJnLkEAzNGcFXHcxPWl+KoQtitSO/4fyirb7VjFAn5kb44ygYSLGQo46uOhRJMO9cEYlnA7h6T/T7SmhenmbqaXIYidtQlJQ6OdvTL4GFrVOqQGDD+q05kqM873w6mmAmC/2gb/wkH9CIcrPa9yJhStY3+EytDt13Ob55cirgmZlALpxy/gvEuYGcugpHVlK9gySbpopDtJdwB3pUv0gF2LU=
before_install:
  - openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
    -in release-keystore.jks.enc -out release-keystore.jks -d
  - echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
  - sudo sysctl -p
  - echo $TRAVIS_BUILD_DIR
  - mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
  - nvm install 10.15.0
  - npm install expo-cli --global
  - curl -o- -L https://yarnpkg.com/install.sh | bash
  - export PATH="$HOME/.yarn/bin:$PATH"
  - expo login -u tidepool -p $EXPO_PASSWORD
install:
  - yarn install
  - yarn run pre
  - expo publish
matrix:
  include:
    - language: android
      jdk: oraclejdk8
      android:
        components:
          - build-tools-27.0.3
          - android-23
          - android-24
          - android-27
          - extra-google-google_play_services
          - extra-google-m2repository
          - extra-android-m2repository
        licenses:
          - android-sdk-preview-license-52d11cd2
          - android-sdk-license-.+
          - google-gdk-license-.+
      script:
        - pushd android
        - "./gradlew :app:assembleProdMinSdkProdKernelRelease"
        - "./gradlew signingReport"
        - "./gradlew :app:assembleDevMinSdkDevKernelDebug"
      deploy:
        provider: releases
        draft: true
        skip_cleanup: true
        overwrite: true
        api_key:
          secure: eGk21GoWqTpy7JXrYMybgGF7hb59qWCDTHR2F5MssCL4n9inAoD/5TAaTvOJjYQjqApAa0ndz8yH85GbSWW5uQDnENJiNV7vPDzFiEkKeFpniLzgQpgwdODdFaerLMiGxRzzc+tH12ZUvmmx/gtcsgJxEAtV6+1wot6ONuK9ix6kl8+yuq3/HgpdRVM/HYPsqXE6q34jFfAscOCW6GaP+xigNNvEIr3H4Ljupp6OaubPmYTgqhwq8l0rEgCiniohSJg5l1ybQ55MjYSUoLb2IRGsgLC5aE2xBlQwlOEDQtBiCIGSDt7aX/UZqIl0/UH/LkPyftT25qEyFMkFucJW4uLoG94cbbrSkVoySeU005MF212J8pxZUivoyqjmA51gENA1G/PVR9uaKdFGBhtB39Hrr6+6c8SaFyKg33HRy46soDMhQw4Cdv3gS2DfLPnUf8ITMnSNVUshr8A0EWF3v1Ykdg1oul+GZqY8EsQ9xe7OHWN9Ap7Kkt/N82JsRFzQsQSFzrvPZvdkHRVUHMiN8kRFFnTnOb5TbFoZv0m4fPapoagNghkyW0TxLtztx3DShTljbskT3H+Mv4+u5DqoGyxFEI/S7xzFEsFZkpxi3FQVL7id0GQa3/+9BBUVgm7hN8csyMcQouCYdIEQTgRhfNBNWPRYy/4BDOyHLApOtpo=
        file:
          - "$TRAVIS_BUILD_DIR/android/app/build/outputs/apk/prodMinSdkProdKernel/release/app-prodMinSdk-prodKernel-release.apk"
          - "$TRAVIS_BUILD_DIR/android/app/build/outputs/mapping/prodMinSdkProdKernel/release/mapping.txt"
        on:
          repo: tidepool-org/mobile
          tags: true
