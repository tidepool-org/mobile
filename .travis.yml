env:
  global:
    - secure: 0YNWM5/PqK2AAwANlfRbm8iTRZgMgcofnvo3/nkpRMIctmTzCtiLDxiz3UDnddtCsqapaUtBhrdk8VwicWVpNMqJNqScKEmOP/eN2YHfxQ/FyGnr/arqpwXnmgXGJ1GkXeJnV2EyBnBAwEzQ5Zc95TTZhb3wszj140HryqNqfNom8TUtAPSzrdgr2/adXYo861/20y3fcmhTT1j/Tw/JHZbj6EE9tpsRuS5TG4UMHA/DNGgPCj4bDZjXXjDTX8AXs8sY65XWTsV9BXZV5AUr/v3IYW30fCVGNVZU1nbiMWfEYWRJPoSMbFqXsrIDK/KOXk//+EI4zVbgHhE5IsRW5uv7ybBgqlDbd+OU8xABrzq032nAs/9AvrEATJJGecddgC5JM7T1F9uxgsC0uxEVZXvSPL870nMOPo+NYkcRyTqAKciyo/NjtfM78W4FHyflC8eCme+QIUp9VXQpT7Fdk5f1c057IMiL6E/tI2+0FNTTNs/m5avbYfiDBrRFH9Mf+FHry2wSr7W0QhG1zpCs6/7tQpn+kRyOjGY4DdA2nCHn/L5lDHBD2YuEFKRyOSCMCbYVy7S5VjQtAyvxtLO9vCeE1Aj9WM3I0GDrN6sPcWPUwFfZA6tp1r4kOuQIE4AvD44avzzm/NibNIo5pZRoScsyxPdNxiBOkbOz9PXTq80=
    - secure: WeqzpIp1T5hj0d/VK95RL0+w7JvUDc+WB8iEfRv/ROSLv+Jb9j7a+tLN3539AUY+EXpjuwwNI/kzZf6ZVAYwQDuKc/o/5jEISsV2VTcBt7Wt03DOJsWKA7roLcsMbxgs2jZlBF8+HZrb+rxirb+g6Ngdlo6GSlLZy6UDJejzLEPlxM9K5eDhx8SeQ9tTqwVnI6J/HUYpbohlHvc/NJvTuCx8Ei2hx+ELoNukQOxTr2Q3O8jAnsVe0Dl2bTo4NmkuaH/uE5exPYcMdDpsZrG27eLD0mYV4fdWMJlzYX8gC2lZC3HqUKUGiVJ5y0tgu2+xRQil1JanxtAnYhk0GDcge5qqeL2fUy3LMIJMVJ45i1JqrF/QGvwi22pmdq7cWdr+Byo9H5E+gm8GkB3MAjyk13ehrXSLY5Mv7JJi0jCnb1SNlGcMwu1DbIHMD3PnJL135qBtX+1aM1NWzlPTZiXJy0MA2O0KBbRVr9CCqFH7gyx4xBZP68auF6TeTyleuoh+yMcPu3MDQLCGdPPqcp2bFukf1QrJaoKYmd57XXFAYwh3NyMqr179RN84PYViUkZwHdO4XmQABB6Uo7Yczo0rbKUOBf9rRBf7oejRBNgMYpTvIOi+TftfXn+oI3g8ztX4kKlVx7H5Rc51eMTIVJAhdsORbpeYVrkagufEzqcJwuA=
    - secure: sVlgYOjB0ClCZLjTQxh4Hb3ajGDDqACsc6T4F1HEFg1TRrZuW9nwWgnkZmLjX1+V2EXOkVb4HglJfamI5WmYoJ1BC/fcU2j2+TgfF9HmPL4UbVCp5Dgx0FAs4+t80eakItpPPSHN//45S0Kzc4WVzy9P63t3H9b5855St9lOdFY5PrA+b4TyBkR+X/dtaCuKtMTJiGCC5JTef2EHVniHmkftk49jAEx4Uu3I8ZXpj/wXSn2PIZ22PkA9Ig+luA9F5dJ6QLPGphVmbHnoaZv/64ArrrOstr/g1fphROzTfFGihdS7+Jilol+APMmukAWuWeAnfxehcliPEx/VVMjBEb4bE38nuNbgK+KB0G51PT5zDIylA2c2rK9mmud1Hk4SmCQuQE/kND4e61JPHyPwlWZOEuk42SrCjZ8N7n0TXkT32RcWScQ7ccTe+J8ZeFHoxiCLFovwwMIXKOkdDmi0HoI1K8zwPZzCETF+j7F3bJRZOTTkXBD0lwc/6mGaHqwrAxHw5UuPXkhh4+5rD4veXWuLY8Gh50jBPSSbT6at5g8pDFh8gdSyFo630dZ1bta7PT5rS7/GQqZNB4JL65JTab5D4nGWrRlozFU42i6sS9KKoN7xB3O5HFEbk2rFc7ZNNK97HilGf71M469cT2C79zJUC5rEIT6S/Wat6s0I3Wc=
    - secure: Qu3MD9YYG0QxMvvlV1xGHhLjhEvoafJZeP6iuZkVY0zwmn7WDHUwHXt1ntMRnMNGyTkb8yjWCkCY3NwosKkkYWZC5mM9Lhmee0oqe8Cia3JSteOSbdgPrSw38eZhaw1rsCXgYjK0Xx2dUPWOAsA+DfVN1/GOs08qy2lMRA4cKVk2C0MvvNSJhiBW9my23U3MJFOaMr3c+8kPi8UjAGJrHGyvIfE0m5Z9vTqfU1xJaJSruRlX1HkFqn0T5Ye73+QukznsmbcC3fMSiDqdybnf3tCzNjUqlCLnqFBb4Qk0LzaVUHzh57pIxuW60AtKS5FIOxoMNx51Y3XudUp0Wqok6jnt4cq+7LIGEekPfPWGmfzFjARe4dE4fWQ8GqNH11BR8pillYNAMWfbgkdTVTZAze3jAfD82NOH6s/DRTjc+rRq10BeZmDT+iHJKAp8ONRFxD7LsYgg2XcCW5Okpdkui7Oy/FOva3HmzQGnRi9XL9AzvzlV22mHUxvhewBtELUL7dGequMYHPB9FbT/ZuGcPYCc/UkOq7N/eYRhdhjaOjg8Ks4tR5nbKM+Aqo6ifZUf9W8V6GAOCKOC06Ws62LLpJjgUDT29jiI/DIhzdOBEZR1ZE77mUWRQ3xP+25DKowXJcwgFv4Oad4sODswd94wYZ85d3/v/RpOsPIoKHWL+iQ=
    - secure: TydWuOmaQT+uKX0QcNv4Si3WHJkxZH1UKdEPx2wj89U/+N+vARpv7Zia6G7ZWreQx0l20BExrxpf5urUEYWcYf4o9kbJpjlvBq5ox8fbgUa49fGzLvQsUR8WOP2bal3ILQKUUJnx9kltuRJEqCsnYRSbQ6XBsPqXbOV3HlhQ5pSRQJ9RadsTOBC/9XrLXzcpZIWSc+d5W/KCU5llVNq64ptfYGKBWfeZPcghjWZTENqk7UzTcjgtN6IcYjVbWCsmGGAbWNioiqYXDvvgAtxa4zfwphWZBeaK2hYAsuNKvy9OstdYka3m5jrrdlXsICNV0nUSbvE4p5S/A8xFabBOMThrbflhHgtQ3nQLXHfZsEgAPAbcqfX0OPQNtTnK8QRoiKKHSZwfzoGClVk0tdf8aFx3Mi8RlAc0FJ+AIn7+LOObsLG0dl0+LDoDWFRR1QGctbgc7l7vgnHCDD0iUGe1ZiFW+2283T9cGA82hf9gVyaf7TXOCcPVot347/1xC/oespasaMEKPLrDCC9cbMz3QwjYhj+VYpRhqFfSBNfT173aaQVYHBOzWO1yijm9TIuu9q31+Rvz6Xym1hRCSCctL0j5trAPoJhhJNYSFnH7y/Fc4zdfZp3tHEAgNx4zNyIi7gVkOT1PDUzTWhn94Dj4VF/CEJ06RFn4S+knidGTbWo=
    - secure: cDnamgsgzKz8SNDVlEC3vn3Dps4UaLdISMOD+oOGtBh4mltsMlobXNxkfkCI/EYifcGMuhoUzoVdLlITDr4w+/1guqa4os1YLOBVygZNE2FG9FoUxAAuzNYmhQqHt6FntBfNGeh/7aS1SpSXBYt8ghYCAz6/pt9SPmDkTEU0JqIfLWKkwCPZL5FbHxeJAlaDZ0wVM4gsQSztZIHw0VBIn5g+DuEobRvnKrkSSJVY5TTU9HHj2CFmFvlJpJiYIHPfwAtJF8Xr255edkBDZNTo9BI/OEkSg6qpCOVvqtly1OVvAxQA4ribEPevtyJGYhDzB5qI2mE1sNoS7pwLjmSOgx9Y6aJKBgCjSSQsk7fR7J3b9mg5tS1IvJ4wz0kgyWJ+5xXVk+zyA/UoiSXHMFGiKbaYr9Wt0tHcD5bdC9qW3RfLy85ORhSbY6QCLIQ3LqFHw36HwAmxT9IDGN7Xrk2e7ewPmxkiG+FpiBWtECTZRQ8qyzsVag50xICp5yfl7pkPaVv4EmOqSTx3iSuKKex1FCFqTBH22iHUlaV0kt+jiPuDrPPnwgIe7WGTHsr918SHgTT1iuEX7wc8Ru+ISnz3qVnrXZY0fQBJA7NozfI17ih+1lOJrV7x2x/tkLuVoW0vhtAxDKqQ5gOgx1FhPZBamzYMchEpAOrJpG8nPzkZAEQ=
    - secure: ebmwrb12LOXRlgQ5bFH7tNyRdSWrLtPrJcVnmqDf/h7CEQkRCuzP3CKsOKgr5yOcOOkfTHdarsK017llzvOID54BHM5Av8vnUW2gkdz8BSRu5+wyjX+TG4h2zuLhtjhG/nArSSNILqjvoZzA3ogMm12ua2Jh4NcjjO9nBSnn6OpGqlNXS2o856N7m6N4tuQlmQCOpA0rplfji8Pn/lzfZzun0jE2s6kWJ3WFmv685SjtDyCcaZxJyIZ9NVs5N1ghQPeztC7yaGyRZImdh1wUnFuabSqm7LFDGUYThoodM1QqOWfgFrNeUYT40J1hr0LVTfvWopyhLvOdJ70sJPjUnGZHUzUGfx0rxvR04JzGl9TnuVALxAciYu6kV0Dextf+J/XDstsjbDDsPsDX6UBjPGzZ5Mfyof6CUbMb6Mwlvgfymy3uKnPCnqZ/97nhsVwQv7NwM3n8pxhpwHdrpHdkXc2Fbczbuk3G65ZoTK7ir13rtUNiI9jWGb6cUofnrxQk1p5kaBNrTsU3zcz2irBXz8B/IsPsoTjZgX+eU0HtsSfrmLO/j6OEHa7iz9TO6G3ayZBUIHFQ9eMSU9EUwOmJzEHZwDaP7xsGvsKmM3tFnR+1NOJWeWSK8fmhfC9Kgg+iulYiwwgs5zsKVB1QCygrF21lO5sQ254UtGqgWjpaqjY=
before_install:
  - echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
  - sudo sysctl -p
  - echo $TRAVIS_BUILD_DIR
  - if [ $keystore_alias_password_test_1 == "test\$\#" ]; then echo "matched 1"; fi
  - if [ $keystore_alias_password_test_1 == "test$#" ]; then echo "matched 2"; fi
  - if [ $keystore_alias_password_test_2 == "test\$\#" ]; then echo "matched 3"; fi
  - if [ $keystore_alias_password_test_2 == "test$#" ]; then echo "matched 4"; fi
  - if [ $keystore_alias_password_test_3 == "test\$\#" ]; then echo "matched 5"; fi
  - if [ $keystore_alias_password_test_3 == "test$#" ]; then echo "matched 6"; fi

  - mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
  - nvm install 10.15.0
  - npm install expo-cli --global
  - curl -o- -L https://yarnpkg.com/install.sh | bash
  - export PATH="$HOME/.yarn/bin:$PATH"
  - openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
    -in release-keystore.jks.enc -out android/release-keystore.jks -d
  - expo login -u tidepool -p $EXPO_PASSWORD
install:
  - yarn install
  - yarn run pre
  - expo publish
matrix:
  include:
    - language: android
      jdk: oraclejdk8
      android:
        components:
          - build-tools-27.0.3
          - android-23
          - android-24
          - android-27
          - extra-google-google_play_services
          - extra-google-m2repository
          - extra-android-m2repository
        licenses:
          - android-sdk-preview-license-52d11cd2
          - android-sdk-license-.+
          - google-gdk-license-.+
      script:
        - pushd android
        - ./gradlew :app:assembleProdMinSdkProdKernelRelease
        - ./gradlew :app:assembleDevMinSdkDevKernelDebug
