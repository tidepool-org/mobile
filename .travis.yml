env:
  global:
    - secure: u/g0Wgj2SebyLYshN1y+pIsJgsh5gNtIjXanVFcI0vSDJSVBXkNuCz/iJfXfKCvkmODakuzeekXg26xF9HzWMSQ+7J5Vodldm+0a5d05ybQQiJL548RBkXuTfSl4pUAFm5zgkeQjnFNO7+fze57Ezj0IHUIksOV9kriY+x8mITSfUZr/oAR1SYIaL3/tnf88fmpv1XIVQgH0nzOoALAfye3PMSQPtAWrccZTSFtkZ+lbthFgFWWxxOtj6clKtXIh3PL1dUOqdB0z636JzwfzqnYpPMfmFe8O1Kff0plCPEU75Oo7XZXFiHL48BKm8VqRWd9RSYndMPyALZXJddUYEhCQS+RolfY09xK8b4hBQZdPQZ2V+fFPQw7XJO/P+e0N3VqsuRobVM6jkQVCatvaAiMMPJKKRCqUEjN0pTyqzSWQs2lRYHluu8dpwNukQhBpdo3oTGftLkFznJ2TpPsTqVNHFg41ijX4jBl54uIpiOFCCxw3V7okEJzKPeCSG9Qp4EG2+1LKCFvGmbyLQd6Qa+ONBsi6PV6FyZQwzqoqx+ptulyiGNSYy+K+lizOj78XkMklsv5pXA3TQgnnb5KsKmQDFp1ArYnp238xG8N47fR17THGRko8E9q1YREglRmfPdWO/6fi2GtgvPntWqbvQC/c9jEsHC9TmYzeQykp7pQ=
    - secure: ZEPwXWX7aEAIJNU9sdLjmoQECk//VK7o7xPrt3IcNQHCcGDd/GaXlTfPBklefa4lFVRAZyVyBSGmioIZ2dylYw2xpilUvR/xAvlcjZ0yYv60EcGEcurKOde8j2M5al5krkOeZH4xM93I/t6Z/VTKVw12H5AGHTZDZUQ5BtgnKj9olF90EtvTN1OK6SVQtxp6EYLmgf5juzsUv4wDK1FQgXxhTlVoHHnQ0iW/VwvCPlO5XdTgDMlZafIYnNgoUUnIaGYYYZ+6SLwsVFpaYEBCu1fF/KEKcMOpncMWVQivUC/++ZHTgiNLLPXJVcDlXE6HMTvfZvzD2esIaGHhBzdIyNoqONJNnp23ShUaJebm244iTnrPBxSV1fsoCUldibqKX6zJa6J/jDBlErr7Jlot8LIkrZdBdwadSnnJcC+7loXP55hAgH9m4T09ef1gvqSx2lecpZ9pBgKXXytV+01Au8ZRrlVrXCQaamPrhJ1VGnNKSmUJA3XSgOAidJejA9aJ0NHz8I2DIXygO+pWaVnc2GnsrrcXIkBd8SaYDuu7J5DnXMC2v+bhqaqvO/XgmDy8JudsAZ5nyEfnxX38uF3nkCWSTm9OLOn2ZpzFk0KK3zxbUUXbVe5QdjJxRlqn9buT9ndiXtQoN7EZn4haiTBMYurV1hbM2V9VdZvtAwvt2bI=
    - secure: CHxnfSousglzfvg2GufVO5Fxg/EWVS7A05tHOWbU++L/8G6TOW6JdCl7ORyeEPaWbUWylt2kMSix/Gd04b7CWzllA+VwXouZA9DgRiu8v6kIo2Q508VRcPcWJcRoDvjmNbOW+Kd8b1APgyAL7cWfFiP2Ci0VxOcn+il69CgbrQOfqJa2J+F/xdAqTGNDqYrX2UHWjfjHUvUSArr6m7c1AJSWfgagwvrT8uAvCKDSy8K4R3LNNa3T//YyGYs71RlrV/OQ7CqxASECnSjgfCnSy4gL/4JEV9ewEE8D4KyAi2zwj5ci8q7CyxE1C9Y0BWY3qdjemn3m8iBUsrDmEdMSphq0BI73rQw2ZndbpfBqluUKCPOTzuDrT6Ct2xqovUq7GhXd3FmLfskXqj3mw5DjEvL+NAopCDh3sIor99MPkaJjHHdkgqzDMj+sa1LiA9W2fbuW5vrV3jKYw5hoC/uEmgrOnKIji8Gn0+3klihvz85jNVHXtK4LmKvQo2GE9rksdRkZEAmJxYgn4lyJZxoniUbUv9+9xMrQAjJ0WTGF16DYEbcwd71gT18PeUULhXSAAqZuN/4/2WkjIOqcXapKz7Vcn8Mx/bBypRmpiZkWOA6sH/tcn3yp29alubIP7Q6xG/2Y722mNZdlwXN01sqJBh2QCVzsXbCtzlRCBjROM9k=
    - secure: GK/EH6HGfYqQ6A5Uomp/F+n03ZiQvAQejoaZW8g1TLwwkLZbpBmN7f3tx8mYbKMaq5mkUV3k3dKlS05n8r1HTf2gBCVYhBmS97gbWNcd2bBDkeuNTxKHVMYROVYaQ+aVzJeXy6tUOJfzhn42ADz/9KLdINUNidSodJxZMdBIo/jfKtUksyDfvrPteN8wk38BHGDxjMg5REY/oLM7GGen4Beqs0a9+q7DVF/lhEIL4iL/yaoX15oPXnzuygDjX9ngC792wGMVic8/Q1LzjAra1A1nxISL7YkDICmqYLqJ9VW4I/utHPENqnvV1dAI2LsZucw0xA/COkf7wKp9uhkf4r0CzmtvUyxkny34dcbRl1sqbkLlchYQo0zT9/eu/pe3rRMnPg79VNl+pNhgT1NmEmZb0Du20dDuUmnRq5o53Mav15ECa1Sqnc9Kfa4BTOnJ0f6X1qkZGftLAsW9RlMDWW7FpSwXmMj0bleZSRQcRgJosjOJJgCBBpS5/1j8jzZ9Zj0SDZfgAxDrpwQGkGZNwNmDSJH9JdtXDnIGbe+xD+J/JTVgeWCiRPveGCdFaQbkFmYn9q5NbBsQHqHRqyFZ8E6kkmhGOBDy6OSQHybdMNBxG2FtAeRxl4+0v0fW1nCp1B/kufqXTZyUPKWYtOVsawoK+VfipXgFJPx6BVau0ko=
    - secure: VScsDk0EqkxNEcLfSUP4+/zFly8zTT1B94vZjZ+aqIcMBeJNWdx30iOMARUZi35TV6LxFBAoQ6hEtbPJFUfH41+ea15cgSR5Ql+5cgz5QSIyqKPP9W54P2AMbRsIUksyLq5hpLQ2dEj23BDZaN5Y/X184o8eWYDMmAKC+L5FnN50/sLo7JPLLi8EBJrWGvs1/KPOhnHzi6BRPTfNnmFqhlaiQ92Lo/58w/jJ/uVgf4wmhIMW3LkGMEY3M7BFqpOZjP/T9erYYdp2fI3Q593NzsZTDNEwQA+QY5aUm5VJrlbtm1CTdFn48Qu/Wv80TFTAF2PXPQHSpCM6nJNMazi9lISO5UY0K/lWyWxEDt+CRKQ5Lf6jHflSKB2ttLBMAS3do+AF7msv3M3HTVusaBZfbcc9ndDHOxMLy+7GQ2gdBykkqQI9zh39DJL1ihAxl0HcHZXS1eSIyz5itncJ7ZivC8kUEHCDrroHS5XiaJwJzcEX8IsrDuAhgO1mcnnfve+5dfi5opX6fvzVxFmTA4RG4UeSd12zg4nrJZTLli8z1LWcCyvmqfWnqoDrHDdY1o2ZKITHNXFCU8k8oRp6i2MiLOv/hz6O0xODSe8EqgftoyaAiMwpDCvrEUHRQZPcsQ5ZdzyRm1+i2UdJdPjH1jLrNzxl0ygXvGikjEiAKcVuhOo=
    - secure: NOwzeyfDYn2sZfSONIFlSs1DbuoN/a2MKrR4q1pbXT0qTlYThU0ihe/1O2/xWWe8uiA270O4Fjdjh7IS6uEQ81oRTbFXeirKOP/4L/MZhs372lPY8SKyhi/n/3EEd5pPQXIOT+e3Ye0PBg4g0gvRyd1GCdj5phOoGaoUPOaYFNA0RJNPD2KhbXTWssFPRvQrNUuUujfF+HlaPjytngfoal2NWgweKWfadTrkqhmIFTurNkCWkIA2ETYWAd9958tvpc6WU+7uTogicdnwOG6mChwD2Zs9v/8qY1eKuDVV3s0n8xtkHLycossfLjfLXtM0sO0A0iR2rrdErTwknmV2XnMtnUyr8D7WYwpAXzJybQqYYq2RrKKLQIQu0C01yvCPCb2ziJHGlWt9OEqYoJzB3iqyf+Em8XboYdbtJh1yi+CyUqsHbcneQIS2s54UjJyK1cSiBblmOO/t8u7gW9iSXdKT9Imoc2SjRT4iooM7lAz9eTJm5q8iFzqy2geW2k+nDCGdiUSO+cwqYHiDvuzDU6AUAwmy0hld1AR30wvjlguLILaUHONhDTdgeLwYUDK93gQTjH3HGeym/gJAUDpTnNGt2Ns2yLIPD0yEBnRDVuw91u6r1bxh95pHRyTERXBDdG2BZkNaQ/sLSYU+dXyxOyJ7sfPANmz+dkuWfr0N+g0=
    - secure: xPsQO9Mg8qfrdy/NE+abIogNgy2JP99kpUQLXj0Drvylvlxssqa2MkUYpGx9mQeYIRg4RNVF4BjIOJoE2UTRd1/lxoI8AMixJyqqdWrBuWMc1Pxb0QLTIo3ivgw0U+Fd81gVcN5no3zwbtqv5KSP8Lp+LdtoOzCBveDjGEszlUSdyrF71m3DLa2F5ZkIXx7pRzNdeywFoPNQEwlq/1dhzFPL6ij06XIAeR2bk83NHirxM72as2WHiZNEcR/32lv6Jj/0LT6beSxfOOu6vv+ZHhe6mv2W767aneCQWE9TLfdUMwTpDuN8yZdLMK7hKiO7ocSsAw/Aw3YzHonWLRWBrosfxwKzAEb7Nsyz4KnEl/8WKyxvhe7UJ15zpN/7HYlwDR5Vf13lpFavOIeADqBijBwaUSklGQlglDNcIllEQdO7ypgQs1Q+fZShTjGOZk4cQpKEYxBmYgtFMBmr+UKX/CPaBgPtAe7MX6YWSDvHAEU4w/NdDdV9Sydy/Qdb8LFggfPMlSuxrFOVanfOmVWtcIYU9OCMxwGu2ZpBLu26pfXggPM3Mwla5HUav3vaaUnoO/2FBgbJhbPK72J/orwZKa4Sof28o8mqNeinu8dcz0FecNRJsNBQawT4ReX1x+bHNlY2kScyN+LGRqsWWL6Pc3K1RaHkLUhBFPjBkec9Xuk=
    - secure: fAp4sFr7ipZ9gLO70qxr4TH6Bqbj/yqsFAZtQ037qf+aiGy5xbMsdoQcoYEJrii8sdv2Hv6mUIHmRmKYh9jNI1WDItWc+nebZeTJ49rSRQSywITaBYoE6/5hSH/JmZvusI0GxXMhRtIEML4kd70Z8pwJiAsdG4HQGRJ2DolBU5SKSmTP9pCM8/ovQDXUs4eyoLzrveRkeSkczQ8Egp7+6F6PTqWBI0RTPL9IUFIeB/5BBLgrWoFH7/ZRP69pkiSyexQoXuzTZifb7LqMsSF9KuD6xxenxPO0DM/WbWimbp2DuQjFJt5OBzL6ziAev6h8E/lgoLzHgil8sqVaYr9aVVKk0AJWPbA3yqfw6Jhs9/nPG5ESuLGPpzIijttCTd8iDZ809uZdxbuSFAR90thAl7Uvun/tYdxX29tNxrz8G9H6zTYk/79Npw/fiul/kj6N7LhlVCcd4h3zXVy9mcTZeGb3twzaiy1/z/FAt9n+XcnoYgS64nO6GiNwXgz05bbNrlotfUNoRNfup7f5XzI2ZZcDhKY7m6Uk1S8rI6pvBN0xjU+Q/hu5knrEjEnQgVi4/J9djaawv0ndM6QVcC3ZXuMNS3lP6LeA5ZNyOXN0RmQaAHaosrHiMsQxwDUnXWts8EOumyHQG+vRbiuwTfQscNYsrVTGNxaHDNe3vpdTeT4=
before_install:
  - openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
    -in release-keystore.jks.enc -out release-keystore.jks -d
  - echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
  - sudo sysctl -p
  - echo $TRAVIS_BUILD_DIR
  - mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
  - nvm install 10.15.0
  - npm install expo-cli --global
  - curl -o- -L https://yarnpkg.com/install.sh | bash
  - export PATH="$HOME/.yarn/bin:$PATH"
  - expo login -u tidepool -p $EXPO_PASSWORD
install:
  - yarn install
  - yarn run pre
  - expo publish
matrix:
  include:
    - language: android
      jdk: oraclejdk8
      android:
        components:
          - build-tools-27.0.3
          - android-23
          - android-24
          - android-27
          - extra-google-google_play_services
          - extra-google-m2repository
          - extra-android-m2repository
        licenses:
          - android-sdk-preview-license-52d11cd2
          - android-sdk-license-.+
          - google-gdk-license-.+
      script:
        - pushd android
        - "./gradlew :app:assembleProdMinSdkProdKernelRelease"
        - "./gradlew signingReport"
        - "./gradlew :app:assembleDevMinSdkDevKernelDebug"
      deploy:
        provider: releases
        draft: true
        skip_cleanup: true
        overwrite: true
        api_key:
          secure: eGk21GoWqTpy7JXrYMybgGF7hb59qWCDTHR2F5MssCL4n9inAoD/5TAaTvOJjYQjqApAa0ndz8yH85GbSWW5uQDnENJiNV7vPDzFiEkKeFpniLzgQpgwdODdFaerLMiGxRzzc+tH12ZUvmmx/gtcsgJxEAtV6+1wot6ONuK9ix6kl8+yuq3/HgpdRVM/HYPsqXE6q34jFfAscOCW6GaP+xigNNvEIr3H4Ljupp6OaubPmYTgqhwq8l0rEgCiniohSJg5l1ybQ55MjYSUoLb2IRGsgLC5aE2xBlQwlOEDQtBiCIGSDt7aX/UZqIl0/UH/LkPyftT25qEyFMkFucJW4uLoG94cbbrSkVoySeU005MF212J8pxZUivoyqjmA51gENA1G/PVR9uaKdFGBhtB39Hrr6+6c8SaFyKg33HRy46soDMhQw4Cdv3gS2DfLPnUf8ITMnSNVUshr8A0EWF3v1Ykdg1oul+GZqY8EsQ9xe7OHWN9Ap7Kkt/N82JsRFzQsQSFzrvPZvdkHRVUHMiN8kRFFnTnOb5TbFoZv0m4fPapoagNghkyW0TxLtztx3DShTljbskT3H+Mv4+u5DqoGyxFEI/S7xzFEsFZkpxi3FQVL7id0GQa3/+9BBUVgm7hN8csyMcQouCYdIEQTgRhfNBNWPRYy/4BDOyHLApOtpo=
        file:
          - "$TRAVIS_BUILD_DIR/android/app/build/outputs/apk/prodMinSdkProdKernel/release/app-prodMinSdk-prodKernel-release.apk"
          - "$TRAVIS_BUILD_DIR/android/app/build/outputs/mapping/prodMinSdkProdKernel/release/mapping.txt"
        on:
          repo: tidepool-org/mobile
          tags: true
