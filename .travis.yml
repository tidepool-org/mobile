env:
  global:
  - secure: fsXCgpEolNQLnX+wKCw8J8KYfm1KVwOAXE3G768vRb1yoeCH2+G63UkRgWzjSlyGzuWOab/FE4Umd0lUXdIxGihJeql/ZZ02ezrROi/zBieAa5bMXP7s5ymjvzMcs3gzwPQB9crX0JHlUtpwZYFIbi0P06IzYZtyKtyn06il3hyyk7MB1rWAlim9EP3n4EI2lIGcUuqrzS5THXpXAwLJVDSeBqKoy9QdJ3vniocRnolGbLa8SQqAnTNlvc2YK1XT2IrZ2ORTEimRGdLD7YFU+7gmJV8ttBifaLeKG8dHSjDS5mpIXm7R2F9WfXSmVu+4VsKCZkqS18L7F9mvIZfe9R25KtOYCOKKSjR8qih3SVuqdZeF6AcridGaLLaN+2w0lTeXek/sl7l1lTthGoffKA5kdmFwQ9aV2gzuDm6ubF1c7mdCbc83D7yfoJzs5zp0fIVtnv7ItxcsT319m9YoT6e4Y7oXvTt/gxLiJK/JdXWSb2PU5GKYRfTa7h7HPUCixukQQe6l3tsQ1d6031bnaImudf2XbIc0EU8BjKWHgpwKMPn4gEAUx7DlpKKZpIQo4nJNBEzwd/zyRp5vsgrmVxHNSc6qMk2MZRoMCVU5K1/PSjieRc1N8LMGCDBtke1buoEkEUljihImu2OyAe2as7p/zjRzpuLK9rsV/mxVF7I=
  - secure: MQpnQ+kuNE7ew1wzWkCA2Jtwmssd6gyM9UZcqxyCPeOhiC8/sBfX9P+R+X/X2aut8J8L5kqZrBGiE0nnaLxqwKH5iQMnyCr83WbllH5cHHY+VO6UN1HjNceI3FHhWNtYmdKwuhDiDW214sN+4t6r0nnrEQ3uHcDdKHy+Jmg/TJTGcthUadpaXR2KLjWCk7LspJpMBUQz2MNnLSTHT8m7RqcdRU5VODTR82BEzuOGIuOBApFID6OInVx2yQnsuLpinRJCOCZrzHDwxnrQQZaD5CQowZzghHgMj94Sxu4oNCqJyYdtTpJUefh4Yab+SURFa3gwg+fdqYCuUjA5UqKbpA8eQSC8lMh78ahjvKsf1XJbLf+uccOWlzDT4Mob1yvznlGXq9b+HGqne18ip4SQT+6g+ObMTbuRqK/e/U/LYvl1xO6Do2wEQMHIaXE1aX44N77ULc4m6I+dRcO4SdkDZB4zgPVaLuMi2i4IKrU/O3VzLUB8bMcHm6Z2hVXTZEzgwA3ijkJRt+jbwf8Z/0bX6/a13EVRphmdkAx4DJebazLV4Gk2pLO98fN80BF/Ad9CaYMSor+ZtYe96C8j9Jdm6mKfRY+lqTldGQFICg14u9kzAzNIlDt2tNzsznwnStFWdni0OI2CP0B3vlnOm8Q9fBn5wLgoqnGD0DbbrtAuat0=
  - secure: R4+AZme9ND/VfIenukj+YlwS0fWkp1y3MQD1Icwo9m6ZwUvTihDQ86POwevXPL2aC43I0uICZHCjlUma0ruCkQjTB/X0x71PoVRAOpTyTnKwZi3yoDzEngscDxcak+Xq9rQxfgHJwmwCsTe3rGPwxR703BlDz2dSNrQNVw7H3xQBdPlpk1iM3v4KdTEF0oS0/RluDsG6EQf2MQo6ccuxC5EbAG7O/9EV1Byfz5fZYVWqgiN29+znkF6dYF5vljnguOHHyr85DcVZEHvPJsZNQrRVoTYkpbZ0TgNFBY94zi41oeZG3ZM+1KxXBvYCgdsE1kEKv8TOxeINkKQi3lKByNrDlzyZdrLTB2k9mYHSvbSykDc35iyV6JfZbP9fNcEKalw8roSDLVjaG6SHVspn3kODC4P6KGfGSDgN2TG1DMa+Kww3cb2HUxoCtHrPD86Vanro5DUaquPOayKr4bSqxSCvmKVAj2OcRS6BYGE+SvN7ImXPN3XPz7M9z2TdUagbh0HOXHqCVhyP7EjlEj9ljWaNot+pCv3wOGilcGQUqHQ+rEIJZ24ggCX2UbFRVciOvIa8ULlaj22IslGrBhEKnjbOXXZIipkYtHVjxHiJaNpBK5LSzbmGho/Rv2hwp3jbwX4Em98BGFKchdBQe6HH7amAVx5TyVra2TofVfuoj0c=
  - secure: kpgL7GDGnxh6tCF1JMp75hGvF4M4zd1ZWrviqoY239ibNc1RBgnsUFv62kGG+wV9EFlzy3WXqMMQgvZrIdlR1wM30wRqS33SeJot39I00WLPSQiUEpJ0iQr4SswvFYVA1NZSh1qCR0n8py4s/HHBYyiQDr02wxwA5F3lpuMVaazYRcNrUt/MGvspCZRqTb09WlyREN07dRt9H6XkdZcVOPgR7qbi6Mn8a48w1B3o8+XuSJpPpSvRsOSLFeMYZ2VqX9E6PZaTY5bbkx5lzR789bY/ClSzb9E5mY3n/pjIHzIf0i4eTgttLZqFqw9CSJ8ZC1Ab/e5ah/+EUY3Oh2Hxek5NO7cy0fPkkpWXhezI8/vgMvVgHiulMFa1FxAGUY1LjMh2gywrleaQsBBXEmh9qhxYY56GB7TFQY63nXEI1r7HJ1huGJ51A3dUO5oKIRJnTCK/obQ0+KqlCiTYnH8t6ad/XvO2PtCpgE1v375JKhlRAxiTIS7kcAlLZhtvCTAHpIcKRBv3rX3WZMim5jC7lFVWnFX/XlrN9hAZhntToKJ+nk369KLGKaqR800H5oIPa2L0JL7x3yihnZzsRysHIqobqmKuL9jIdXL14ToPjox8DXIn3eOJkb1/GVXrs75kJ8jurc87qaKHEWTISshLR5dqqucVHlnnBFOiDwpHliI=
before_install:
- openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
  -in release-keystore.jks.enc -out release-keystore.jks -d
- echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
- sudo sysctl -p
- echo $TRAVIS_BUILD_DIR
- mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
- nvm install 10.15.0
- npm install expo-cli --global
- curl -o- -L https://yarnpkg.com/install.sh | bash
- export PATH="$HOME/.yarn/bin:$PATH"
- expo login -u tidepool -p $EXPO_PASSWORD
install:
- yarn install
- yarn run pre
- expo publish
matrix:
  include:
  - language: android
    jdk: oraclejdk8
    android:
      components:
      - build-tools-27.0.3
      - android-23
      - android-24
      - android-27
      - extra-google-google_play_services
      - extra-google-m2repository
      - extra-android-m2repository
      licenses:
      - android-sdk-preview-license-52d11cd2
      - android-sdk-license-.+
      - google-gdk-license-.+
    script:
    - pushd android
    - "./gradlew :app:assembleProdMinSdkProdKernelRelease"
    - "./gradlew signingReport"
    - "./gradlew :app:assembleDevMinSdkDevKernelDebug"
    deploy:
      provider: releases
      draft: true
      skip_cleanup: true
      overwrite: true
      api_key:
        secure: eGk21GoWqTpy7JXrYMybgGF7hb59qWCDTHR2F5MssCL4n9inAoD/5TAaTvOJjYQjqApAa0ndz8yH85GbSWW5uQDnENJiNV7vPDzFiEkKeFpniLzgQpgwdODdFaerLMiGxRzzc+tH12ZUvmmx/gtcsgJxEAtV6+1wot6ONuK9ix6kl8+yuq3/HgpdRVM/HYPsqXE6q34jFfAscOCW6GaP+xigNNvEIr3H4Ljupp6OaubPmYTgqhwq8l0rEgCiniohSJg5l1ybQ55MjYSUoLb2IRGsgLC5aE2xBlQwlOEDQtBiCIGSDt7aX/UZqIl0/UH/LkPyftT25qEyFMkFucJW4uLoG94cbbrSkVoySeU005MF212J8pxZUivoyqjmA51gENA1G/PVR9uaKdFGBhtB39Hrr6+6c8SaFyKg33HRy46soDMhQw4Cdv3gS2DfLPnUf8ITMnSNVUshr8A0EWF3v1Ykdg1oul+GZqY8EsQ9xe7OHWN9Ap7Kkt/N82JsRFzQsQSFzrvPZvdkHRVUHMiN8kRFFnTnOb5TbFoZv0m4fPapoagNghkyW0TxLtztx3DShTljbskT3H+Mv4+u5DqoGyxFEI/S7xzFEsFZkpxi3FQVL7id0GQa3/+9BBUVgm7hN8csyMcQouCYdIEQTgRhfNBNWPRYy/4BDOyHLApOtpo=
      file:
      - "$TRAVIS_BUILD_DIR/android/app/build/outputs/apk/prodMinSdkProdKernel/release/app-prodMinSdk-prodKernel-release.apk"
      - "$TRAVIS_BUILD_DIR/android/app/build/outputs/mapping/prodMinSdkProdKernel/release/mapping.txt"
      on:
        repo: tidepool-org/mobile
        tags: true
