env:
  global:
    - secure: ebmwrb12LOXRlgQ5bFH7tNyRdSWrLtPrJcVnmqDf/h7CEQkRCuzP3CKsOKgr5yOcOOkfTHdarsK017llzvOID54BHM5Av8vnUW2gkdz8BSRu5+wyjX+TG4h2zuLhtjhG/nArSSNILqjvoZzA3ogMm12ua2Jh4NcjjO9nBSnn6OpGqlNXS2o856N7m6N4tuQlmQCOpA0rplfji8Pn/lzfZzun0jE2s6kWJ3WFmv685SjtDyCcaZxJyIZ9NVs5N1ghQPeztC7yaGyRZImdh1wUnFuabSqm7LFDGUYThoodM1QqOWfgFrNeUYT40J1hr0LVTfvWopyhLvOdJ70sJPjUnGZHUzUGfx0rxvR04JzGl9TnuVALxAciYu6kV0Dextf+J/XDstsjbDDsPsDX6UBjPGzZ5Mfyof6CUbMb6Mwlvgfymy3uKnPCnqZ/97nhsVwQv7NwM3n8pxhpwHdrpHdkXc2Fbczbuk3G65ZoTK7ir13rtUNiI9jWGb6cUofnrxQk1p5kaBNrTsU3zcz2irBXz8B/IsPsoTjZgX+eU0HtsSfrmLO/j6OEHa7iz9TO6G3ayZBUIHFQ9eMSU9EUwOmJzEHZwDaP7xsGvsKmM3tFnR+1NOJWeWSK8fmhfC9Kgg+iulYiwwgs5zsKVB1QCygrF21lO5sQ254UtGqgWjpaqjY=
    - secure: xCrWe+bvpFknRB62w7rUyeE9lYV9g2ArOSnogKfMLuKCNq2KUJrpBulhZ75gwFQrn0yFZnEzXW9HWQjon46SMvt9YkeficNq/svszUDX8y7yd/Jyd85Wu9SI5WzIqFnERPRQZOfu9Mrl7tl+QKCG/LMraMQdij+rO2/WMwHlvXEupPPqc9PHN0C7AGYumY/tOCxFe18ZmLop9R1Bdjv1qB+Nc0pHRXbbeQUtrztuIc24nPo7QuKO5xtWZzVxuCBcujfsVTgbvdQsqqK9iNlt8vHSFz4z/oj3IMlh15AcZxmp+pf/5qrDnrylczcyefpD2gBBna323KmjCRhtwR6OFIa3M5Cmdtso0PtoWme6YmTaIK78wSrz0nnsBT4JWwxKLPNailB1seNm1YlCIg8MpsnFH8Dfkmi46nNaVa7zxZU0Ipa3ZdbWs3T6E8b78JD/Vrxwg2OVzOYwqGtoZcLUKz/ccB/LTW9ptU0qFun7obuDzDEyYQcFMDxZzu5/BeDiXXIW7teSSwlMsG62fVMfaii5rHdTFKU9N9cP3qWhxVNag7galox2SEWvI7X8+fDeBk3yfjFtIcMKywJT70FF7fVEjrcQr2krWEiJZWzW+k5MErILFKGJW2YlgBJu46VE62vKXCSv8hly5yToehWqPlRO2GmJt3jX8FAztU7Sh0k=
    - secure: KCtPXKJ2SaGbkWaT78/jLaBvprf2YTir6D+wuAbcitxJCNw9e/KS95NJ3P/Wde4WTxuRE3/eJzgqep6djXnMlxDeugjPdzvQ++rnHsgCUPXnz1xvVNIxh2lWq1DLRQ+IecP1PK1g7UPF356h2Xnk/Ga0nBzZLPyhVDv+KsARxriKg0GjR1TKQS7+YJ8qXN+aNbFN7PaTRZ6zgA9YBund1TjBVvUs8CEp7B4UwneU2UFVhZ/QZ3cDETTyZ6/lbKC/42cia2VbhHjSDIbQ0lJ1q8gyxaHqGPtvIKaCIpysgifJrcmahtgpoP5XHZK6WUMP+9wwejUeHzjr1WiDwR9/zXFJRfqf4hGgz5EtgFBviTBf2+ZGiu9Axd9nlY9xucTp0o8aWDsbEqcof1aylBIclofHGuicIcKZj03nBovnZv8V16k+KaD/8jwlDyNlgDACO9NwgCnmog3FYgcDjZiUAls/ie+3LZ7i1ukfwPbBRRxDljoYYlwZkw9yZZ9H2N6mVbfD7Vb+FdMFf12Vq9SzkTxtjb0qmgxaE0uLr1KeT36WZCB8XjZL/aQabBXqV9YF45FdLj0+6AGNsOT+sLg475LbAzT+LQS+Fg2SdewZ5x4DYfvYTe6BCvM1AhfAZIopwghea0olz4WFHBIwikGboUCxFZb0OoMo3zr8KajSYUc=
before_install:
  - echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
  - sudo sysctl -p
  - echo $TRAVIS_BUILD_DIR
  - mv $TRAVIS_BUILD_DIR/ios/Tidepool $TRAVIS_BUILD_DIR/ios/tidepool
  - nvm install 10.15.0
  - npm install expo-cli --global
  - curl -o- -L https://yarnpkg.com/install.sh | bash
  - export PATH="$HOME/.yarn/bin:$PATH"
  - openssl aes-256-cbc -K $encrypted_4beaf9ef68f9_key -iv $encrypted_4beaf9ef68f9_iv
    -in release-keystore.jks.enc -out android/release-keystore.jks -d
  - expo login -u tidepool -p $EXPO_PASSWORD
install:
  - yarn install
  - yarn run pre
  - expo publish
matrix:
  include:
    - language: android
      jdk: oraclejdk8
      android:
        components:
          - build-tools-27.0.3
          - android-23
          - android-24
          - android-27
          - extra-google-google_play_services
          - extra-google-m2repository
          - extra-android-m2repository
        licenses:
          - android-sdk-preview-license-52d11cd2
          - android-sdk-license-.+
          - google-gdk-license-.+
      script:
        - pushd android
        - "./gradlew :app:assembleProdMinSdkProdKernelRelease"
        - "./gradlew :app:assembleDevMinSdkDevKernelDebug"
